
<!DOCTYPE html>
<html lang="en">
<head>
┬а <meta charset="UTF-8" />
┬а <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
┬а <meta name="theme-color" content="#0055aa" />
┬а <meta name="description" content="NAPT Word Game (Site2 Test)" />
┬а <title>NAPT Word Game (Site2)</title>

    <script>
        // --- Fallback Mechanism for Original Site ---
        // This is the URL where your Site2 PWA is *actually hosted*.
        // If Site2 is located within your naptpwa repo, it might be:
        // "https://alliebaig.github.io/naptpwa/Site2/"
        // If it's a completely separate domain, use that (e.g., "https://naptpwabackup.com/").
        // !!! IMPORTANT: YOU MUST UPDATE THIS URL !!!
        const fallbackSiteUrl = "https://alliebaig.github.io/naptpwa/Site2/"; 
        const criticalResourceLoadDelayMs = 4000; // Time in milliseconds to wait for critical resources (4 seconds)

        let initialLoadCompleted = false;
        let errorsDetected = 0;
        const errorThreshold = 2; // Number of errors before triggering redirect

        // Global error handler for uncaught JavaScript errors
        window.onerror = function(message, source, lineno, colno, error) {
            errorsDetected++;
            console.error("Critical JS Error on original site:", message, source, lineno);
            // Trigger fallback if enough errors accumulate
            if (errorsDetected >= errorThreshold) {
                console.warn("Too many JS errors. Redirecting to fallback site:", fallbackSiteUrl);
                window.location.replace(fallbackSiteUrl); // Use replace() to prevent back button issues
            }
            return true; // Prevent default browser error reporting
        };

        // Fallback check if DOMContentLoaded doesn't fire or main critical scripts fail to load
        document.addEventListener('DOMContentLoaded', () => {
            initialLoadCompleted = true; // DOM is ready, base HTML loaded
            console.log("Original site DOMContentLoaded.");
            // You could add more specific checks here for essential elements or global variables
            // that should be present after main scripts load successfully.
        });

        // Timeout to catch issues that don't trigger onerror or DOMContentLoaded
        setTimeout(() => {
            // If DOMContentLoaded never fired (page hung/critical HTML error)
            // OR if the page loaded but errors accumulated (like 404s for critical JS/CSS preventing functionality)
            if (!initialLoadCompleted || errorsDetected > 0) {
                console.warn("Original site did not load fully or encountered errors. Initiating fallback.");
                window.location.replace(fallbackSiteUrl);
            } else {
                console.info("Original site loaded successfully with no critical errors detected.");
            }
        }, criticalResourceLoadDelayMs);
    </script>
    ┬а ┬а <script>
┬а ┬а const root = document.documentElement;
┬а ┬а const font = localStorage.getItem('napt-font');
┬а ┬а const theme = localStorage.getItem('napt-theme');
┬а ┬а const contrast = localStorage.getItem('napt-contrast');
┬а ┬а const useEmojis = localStorage.getItem('napt-use-emojis');

┬а ┬а if (font) root.classList.add(`font-${font}`);
┬а ┬а if (theme === 'light' || theme === 'dark') root.classList.add(`theme-${theme}`);
┬а ┬а if (contrast === 'true') root.classList.add('theme-high-contrast');
┬а ┬а if (useEmojis === 'false') root.classList.add('no-emojis');
┬а </script>

┬а ┬а <link href="https://fonts.googleapis.com/css2?family=Domine&family=Lora&family=Merriweather&family=Tinos&display=swap" rel="stylesheet">

  ┬а <link rel="manifest" href="/naptpwa/manifest.json" />
┬а <link rel="stylesheet" href="/naptpwa/styles/main.css" />
┬а <link rel="icon" href="/naptpwa/icons/icon-192.png" type="image/png" />
  
  ┬а <script src="/naptpwa/scripts/serviceWorkerRegistration.js"></script>
</head>

<body>
┬а <header>
┬а ┬а <h1>NAPT Word Game РђЊ Site2 Test</h1>
┬а ┬а <p>This version uses <code>/naptpwa/Site2/scripts/</code> as the source.</p>
┬а </header>

┬а <main id="menu" class="active">
┬а ┬а <div id="mode-buttons" class="mode-buttons">
┬а ┬а ┬а <button class="menu-btn" data-mode="regular">­ЪДа Solo Mode</button>
┬а ┬а ┬а <button class="menu-btn" data-mode="wordRelic">­ЪЈ║ Word Relic</button>
┬а ┬а ┬а <button class="menu-btn" data-mode="wordSafari">­ЪдЂ Word Safari</button>
┬а ┬а ┬а <button class="menu-btn" data-mode="dice">­Ъј▓ Dice Challenge</button>
┬а ┬а ┬а <button class="menu-btn" data-mode="atlas">­ЪЌ║№ИЈ Word Atlas</button>
┬а ┬а ┬а <button class="menu-btn" data-mode="versus">­Ъцќ Play vs Computer</button>
┬а ┬а ┬а <button class="menu-btn" data-mode="trail">­Ъфё Trail of Letters</button>
┬а ┬а ┬а <button class="menu-btn" data-mode="nearby">­ЪЊЇ Play Nearby</button>
┬а ┬а </div>

┬а ┬а <details id="settings-panel" style="padding: 1rem; max-width: 800px; margin: auto;">
┬а ┬а ┬а <summary><strong>РџЎ№ИЈ Settings</strong></summary>
┬а ┬а ┬а <div style="margin-top: 1rem;">
┬а ┬а ┬а ┬а <label for="fontSelector">Font:</label><br/>
┬а ┬а ┬а ┬а <select id="fontSelector">
┬а ┬а ┬а ┬а ┬а <option value="">System Default</option>
┬а ┬а ┬а ┬а ┬а <option value="domine">Domine</option>
┬а ┬а ┬а ┬а ┬а <option value="merriweather">Merriweather</option>
┬а ┬а ┬а ┬а ┬а <option value="lora">Lora</option>
┬а ┬а ┬а ┬а ┬а <option value="tinos">Tinos</option>
┬а ┬а ┬а ┬а </select><br/>

┬а ┬а ┬а ┬а <label for="themeSelector">Theme:</label><br/>
┬а ┬а ┬а ┬а <select id="themeSelector">
┬а ┬а ┬а ┬а ┬а <option value="system">System Default</option>
┬а ┬а ┬а ┬а ┬а <option value="light">Light</option>
┬а ┬а ┬а ┬а ┬а <option value="dark">Dark</option>
┬а ┬а ┬а ┬а </select><br/>

┬а ┬а ┬а ┬а <label><input type="checkbox" id="highContrastToggle" /> High Contrast Mode</label><br/>
┬а ┬а ┬а ┬а <label><input type="checkbox" id="emojiToggle" /> Show Emojis in Game Labels</label><br/>
┬а ┬а ┬а ┬а <label><input type="checkbox" id="resumeToggle" /> Resume Last Game on Load</label><br/>

┬а ┬а ┬а ┬а <label for="difficultySelector">Difficulty:</label><br/>
┬а ┬а ┬а ┬а <select id="difficultySelector">
┬а ┬а ┬а ┬а ┬а <option value="easy" selected>Easy</option>
┬а ┬а ┬а ┬а ┬а <option value="medium">Medium</option>
┬а ┬а ┬а ┬а ┬а <option value="hard">Hard</option>
┬а ┬а ┬а ┬а </select><br/>

┬а ┬а ┬а ┬а <label for="radiusSelector">Map Radius:</label><br/>
┬а ┬а ┬а ┬а <select id="radiusSelector">
┬а ┬а ┬а ┬а ┬а <option value="3">3 km</option>
┬а ┬а ┬а ┬а ┬а <option value="10" selected>10 km</option>
┬а ┬а ┬а ┬а ┬а <option value="50">50 km</option>
┬а ┬а ┬а ┬а ┬а <option value="200">200 km</option>
┬а ┬а ┬а ┬а </select>
┬а ┬а ┬а </div>
┬а ┬а </details>
┬а </main>

┬а <div id="game" class="game-container"></div>

┬а <div id="error-viewer-link" style="text-align:center; margin-top:1rem;">
    ┬а ┬а <a href="/naptpwa/scripts/utils/error-log.html" target="_blank" style="font-size: 0.9rem;">­Ъљъ View Error Log</a>
┬а </div>

┬а ┬а <script type="module">
┬а ┬а const site2 = '/naptpwa/Site2/scripts/'; // Use absolute path from GitHub Pages root
┬а ┬а await import(site2 + 'main.js'); // This will load /naptpwa/Site2/scripts/main.js
┬а ┬а await import(site2 + 'gameNavigation.js'); // This will load /naptpwa/Site2/scripts/gameNavigation.js
┬а </script>

</body>
</html>
